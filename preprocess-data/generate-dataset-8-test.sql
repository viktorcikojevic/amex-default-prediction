create or replace table `big-query-study-338516.kaggle_amex_dataset.test_data_processed_8` as



with num_features_trends as (
  select 
  customer_ID,
  (P_2 - lag(P_2) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS P_2_growth,
  (D_39 - lag(D_39) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_39_growth,
  (B_1 - lag(B_1) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_1_growth,
  (B_2 - lag(B_2) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_2_growth,
  (R_1 - lag(R_1) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_1_growth,
  (S_3 - lag(S_3) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_3_growth,
  (D_41 - lag(D_41) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_41_growth,
  (B_3 - lag(B_3) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_3_growth,
  (D_42 - lag(D_42) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_42_growth,
  (D_43 - lag(D_43) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_43_growth,
  (D_44 - lag(D_44) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_44_growth,
  (B_4 - lag(B_4) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_4_growth,
  (D_45 - lag(D_45) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_45_growth,
  (B_5 - lag(B_5) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_5_growth,
  (R_2 - lag(R_2) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_2_growth,
  (D_46 - lag(D_46) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_46_growth,
  (D_47 - lag(D_47) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_47_growth,
  (D_48 - lag(D_48) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_48_growth,
  (D_49 - lag(D_49) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_49_growth,
  (B_6 - lag(B_6) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_6_growth,
  (B_7 - lag(B_7) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_7_growth,
  (B_8 - lag(B_8) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_8_growth,
  (D_50 - lag(D_50) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_50_growth,
  (D_51 - lag(D_51) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_51_growth,
  (B_9 - lag(B_9) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_9_growth,
  (R_3 - lag(R_3) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_3_growth,
  (D_52 - lag(D_52) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_52_growth,
  (P_3 - lag(P_3) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS P_3_growth,
  (B_10 - lag(B_10) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_10_growth,
  (D_53 - lag(D_53) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_53_growth,
  (S_5 - lag(S_5) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_5_growth,
  (B_11 - lag(B_11) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_11_growth,
  (S_6 - lag(S_6) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_6_growth,
  (D_54 - lag(D_54) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_54_growth,
  (R_4 - lag(R_4) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_4_growth,
  (S_7 - lag(S_7) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_7_growth,
  (B_12 - lag(B_12) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_12_growth,
  (S_8 - lag(S_8) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_8_growth,
  (D_55 - lag(D_55) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_55_growth,
  (D_56 - lag(D_56) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_56_growth,
  (B_13 - lag(B_13) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_13_growth,
  (R_5 - lag(R_5) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_5_growth,
  (D_58 - lag(D_58) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_58_growth,
  (S_9 - lag(S_9) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_9_growth,
  (B_14 - lag(B_14) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_14_growth,
  (D_59 - lag(D_59) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_59_growth,
  (D_60 - lag(D_60) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_60_growth,
  (D_61 - lag(D_61) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_61_growth,
  (B_15 - lag(B_15) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_15_growth,
  (S_11 - lag(S_11) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_11_growth,
  (D_62 - lag(D_62) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_62_growth,
  (D_65 - lag(D_65) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_65_growth,
  (B_16 - lag(B_16) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_16_growth,
  (B_17 - lag(B_17) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_17_growth,
  (B_18 - lag(B_18) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_18_growth,
  (B_19 - lag(B_19) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_19_growth,
  (B_20 - lag(B_20) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_20_growth,
  (S_12 - lag(S_12) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_12_growth,
  (R_6 - lag(R_6) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_6_growth,
  (S_13 - lag(S_13) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_13_growth,
  (B_21 - lag(B_21) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_21_growth,
  (D_69 - lag(D_69) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_69_growth,
  (B_22 - lag(B_22) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_22_growth,
  (D_70 - lag(D_70) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_70_growth,
  (D_71 - lag(D_71) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_71_growth,
  (D_72 - lag(D_72) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_72_growth,
  (S_15 - lag(S_15) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_15_growth,
  (B_23 - lag(B_23) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_23_growth,
  (D_73 - lag(D_73) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_73_growth,
  (P_4 - lag(P_4) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS P_4_growth,
  (D_74 - lag(D_74) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_74_growth,
  (D_75 - lag(D_75) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_75_growth,
  (D_76 - lag(D_76) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_76_growth,
  (B_24 - lag(B_24) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_24_growth,
  (R_7 - lag(R_7) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_7_growth,
  (D_77 - lag(D_77) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_77_growth,
  (B_25 - lag(B_25) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_25_growth,
  (B_26 - lag(B_26) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_26_growth,
  (D_78 - lag(D_78) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_78_growth,
  (D_79 - lag(D_79) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_79_growth,
  (R_8 - lag(R_8) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_8_growth,
  (R_9 - lag(R_9) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_9_growth,
  (S_16 - lag(S_16) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_16_growth,
  (D_80 - lag(D_80) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_80_growth,
  (R_10 - lag(R_10) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_10_growth,
  (R_11 - lag(R_11) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_11_growth,
  (B_27 - lag(B_27) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_27_growth,
  (D_81 - lag(D_81) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_81_growth,
  (D_82 - lag(D_82) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_82_growth,
  (S_17 - lag(S_17) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_17_growth,
  (R_12 - lag(R_12) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_12_growth,
  (B_28 - lag(B_28) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_28_growth,
  (R_13 - lag(R_13) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_13_growth,
  (D_83 - lag(D_83) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_83_growth,
  (R_14 - lag(R_14) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_14_growth,
  (R_15 - lag(R_15) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_15_growth,
  (D_84 - lag(D_84) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_84_growth,
  (R_16 - lag(R_16) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_16_growth,
  (B_29 - lag(B_29) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_29_growth,
  (S_18 - lag(S_18) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_18_growth,
  (D_86 - lag(D_86) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_86_growth,
  (D_87 - lag(D_87) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_87_growth,
  (R_17 - lag(R_17) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_17_growth,
  (R_18 - lag(R_18) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_18_growth,
  (D_88 - lag(D_88) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_88_growth,
  (B_31 - lag(B_31) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_31_growth,
  (S_19 - lag(S_19) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_19_growth,
  (R_19 - lag(R_19) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_19_growth,
  (B_32 - lag(B_32) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_32_growth,
  (S_20 - lag(S_20) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_20_growth,
  (R_20 - lag(R_20) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_20_growth,
  (R_21 - lag(R_21) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_21_growth,
  (B_33 - lag(B_33) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_33_growth,
  (D_89 - lag(D_89) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_89_growth,
  (R_22 - lag(R_22) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_22_growth,
  (R_23 - lag(R_23) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_23_growth,
  (D_91 - lag(D_91) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_91_growth,
  (D_92 - lag(D_92) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_92_growth,
  (D_93 - lag(D_93) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_93_growth,
  (D_94 - lag(D_94) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_94_growth,
  (R_24 - lag(R_24) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_24_growth,
  (R_25 - lag(R_25) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_25_growth,
  (D_96 - lag(D_96) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_96_growth,
  (S_22 - lag(S_22) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_22_growth,
  (S_23 - lag(S_23) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_23_growth,
  (S_24 - lag(S_24) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_24_growth,
  (S_25 - lag(S_25) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_25_growth,
  (S_26 - lag(S_26) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_26_growth,
  (D_102 - lag(D_102) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_102_growth,
  (D_103 - lag(D_103) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_103_growth,
  (D_104 - lag(D_104) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_104_growth,
  (D_105 - lag(D_105) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_105_growth,
  (D_106 - lag(D_106) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_106_growth,
  (D_107 - lag(D_107) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_107_growth,
  (B_36 - lag(B_36) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_36_growth,
  (B_37 - lag(B_37) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_37_growth,
  (R_26 - lag(R_26) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_26_growth,
  (R_27 - lag(R_27) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_27_growth,
  (D_108 - lag(D_108) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_108_growth,
  (D_109 - lag(D_109) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_109_growth,
  (D_110 - lag(D_110) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_110_growth,
  (D_111 - lag(D_111) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_111_growth,
  (B_39 - lag(B_39) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_39_growth,
  (D_112 - lag(D_112) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_112_growth,
  (B_40 - lag(B_40) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_40_growth,
  (S_27 - lag(S_27) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS S_27_growth,
  (D_113 - lag(D_113) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_113_growth,
  (D_115 - lag(D_115) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_115_growth,
  (D_118 - lag(D_118) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_118_growth,
  (D_119 - lag(D_119) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_119_growth,
  (D_121 - lag(D_121) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_121_growth,
  (D_122 - lag(D_122) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_122_growth,
  (D_123 - lag(D_123) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_123_growth,
  (D_124 - lag(D_124) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_124_growth,
  (D_125 - lag(D_125) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_125_growth,
  (D_127 - lag(D_127) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_127_growth,
  (D_128 - lag(D_128) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_128_growth,
  (D_129 - lag(D_129) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_129_growth,
  (B_41 - lag(B_41) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_41_growth,
  (B_42 - lag(B_42) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS B_42_growth,
  (D_130 - lag(D_130) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_130_growth,
  (D_131 - lag(D_131) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_131_growth,
  (D_132 - lag(D_132) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_132_growth,
  (D_133 - lag(D_133) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_133_growth,
  (R_28 - lag(R_28) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS R_28_growth,
  (D_134 - lag(D_134) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_134_growth,
  (D_135 - lag(D_135) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_135_growth,
  (D_136 - lag(D_136) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_136_growth,
  (D_137 - lag(D_137) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_137_growth,
  (D_138 - lag(D_138) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_138_growth,
  (D_139 - lag(D_139) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_139_growth,
  (D_140 - lag(D_140) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_140_growth,
  (D_141 - lag(D_141) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_141_growth,
  (D_142 - lag(D_142) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_142_growth,
  (D_143 - lag(D_143) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_143_growth,
  (D_144 - lag(D_144) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_144_growth,
  (D_145 - lag(D_145) OVER(partition by customer_ID ORDER BY S_2 ASC)) AS D_145_growth
  from `big-query-study-338516.kaggle_amex_dataset.test_data`
),


num_features_last_values as (
  
  select customer_ID,
    B_30_last_value, B_38_last_value, D_114_last_value, D_116_last_value, D_117_last_value, D_120_last_value, D_126_last_value, D_63_last_value, D_64_last_value, D_66_last_value, D_68_last_value, P_2_last_value, D_39_last_value, B_1_last_value, B_2_last_value, R_1_last_value, S_3_last_value, D_41_last_value, B_3_last_value, D_42_last_value, D_43_last_value, D_44_last_value, B_4_last_value, D_45_last_value, B_5_last_value, R_2_last_value, D_46_last_value, D_47_last_value, D_48_last_value, D_49_last_value, B_6_last_value, B_7_last_value, B_8_last_value, D_50_last_value, D_51_last_value, B_9_last_value, R_3_last_value, D_52_last_value, P_3_last_value, B_10_last_value, D_53_last_value, S_5_last_value, B_11_last_value, S_6_last_value, D_54_last_value, R_4_last_value, S_7_last_value, B_12_last_value, S_8_last_value, D_55_last_value, D_56_last_value, B_13_last_value, R_5_last_value, D_58_last_value, S_9_last_value, B_14_last_value, D_59_last_value, D_60_last_value, D_61_last_value, B_15_last_value, S_11_last_value, D_62_last_value, D_65_last_value, B_16_last_value, B_17_last_value, B_18_last_value, B_19_last_value, B_20_last_value, S_12_last_value, R_6_last_value, S_13_last_value, B_21_last_value, D_69_last_value, B_22_last_value, D_70_last_value, D_71_last_value, D_72_last_value, S_15_last_value, B_23_last_value, D_73_last_value, P_4_last_value, D_74_last_value, D_75_last_value, D_76_last_value, B_24_last_value, R_7_last_value, D_77_last_value, B_25_last_value, B_26_last_value, D_78_last_value, D_79_last_value, R_8_last_value, R_9_last_value, S_16_last_value, D_80_last_value, R_10_last_value, R_11_last_value, B_27_last_value, D_81_last_value, D_82_last_value, S_17_last_value, R_12_last_value, B_28_last_value, R_13_last_value, D_83_last_value, R_14_last_value, R_15_last_value, D_84_last_value, R_16_last_value, B_29_last_value, S_18_last_value, D_86_last_value, D_87_last_value, R_17_last_value, R_18_last_value, D_88_last_value, B_31_last_value, S_19_last_value, R_19_last_value, B_32_last_value, S_20_last_value, R_20_last_value, R_21_last_value, B_33_last_value, D_89_last_value, R_22_last_value, R_23_last_value, D_91_last_value, D_92_last_value, D_93_last_value, D_94_last_value, R_24_last_value, R_25_last_value, D_96_last_value, S_22_last_value, S_23_last_value, S_24_last_value, S_25_last_value, S_26_last_value, D_102_last_value, D_103_last_value, D_104_last_value, D_105_last_value, D_106_last_value, D_107_last_value, B_36_last_value, B_37_last_value, R_26_last_value, R_27_last_value, D_108_last_value, D_109_last_value, D_110_last_value, D_111_last_value, B_39_last_value, D_112_last_value, B_40_last_value, S_27_last_value, D_113_last_value, D_115_last_value, D_118_last_value, D_119_last_value, D_121_last_value, D_122_last_value, D_123_last_value, D_124_last_value, D_125_last_value, D_127_last_value, D_128_last_value, D_129_last_value, B_41_last_value, B_42_last_value, D_130_last_value, D_131_last_value, D_132_last_value, D_133_last_value, R_28_last_value, D_134_last_value, D_135_last_value, D_136_last_value, D_137_last_value, D_138_last_value, D_139_last_value, D_140_last_value, D_141_last_value, D_142_last_value, D_143_last_value, D_144_last_value, D_145_last_value
  from (
  select 
  customer_ID,
  ROW_NUMBER() OVER (PARTITION BY customer_ID ORDER BY S_2 DESC) AS rown,
  -- FIRST_VALUE(target IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) as target,
  -- categorical features
  CAST(FIRST_VALUE(B_30 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as B_30_last_value,
  CAST(FIRST_VALUE(B_38 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as B_38_last_value,
  CAST(FIRST_VALUE(D_114 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as D_114_last_value,
  CAST(FIRST_VALUE(D_116 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as D_116_last_value,
  CAST(FIRST_VALUE(D_117 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as D_117_last_value,
  CAST(FIRST_VALUE(D_120 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as D_120_last_value,
  CAST(FIRST_VALUE(D_126 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as D_126_last_value,
  CAST(FIRST_VALUE(D_63 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as D_63_last_value,
  CAST(FIRST_VALUE(D_64 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as D_64_last_value,
  CAST(FIRST_VALUE(D_66 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS STRING) as D_66_last_value,
  -- numerical features
  FIRST_VALUE(D_68 IGNORE NULLS) OVER(PARTITION BY customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) as D_68_last_value,
  FIRST_VALUE(P_2 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS P_2_last_value,
  FIRST_VALUE(D_39 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_39_last_value,
  FIRST_VALUE(B_1 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_1_last_value,
  FIRST_VALUE(B_2 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_2_last_value,
  FIRST_VALUE(R_1 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_1_last_value,
  FIRST_VALUE(S_3 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_3_last_value,
  FIRST_VALUE(D_41 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_41_last_value,
  FIRST_VALUE(B_3 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_3_last_value,
  FIRST_VALUE(D_42 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_42_last_value,
  FIRST_VALUE(D_43 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_43_last_value,
  FIRST_VALUE(D_44 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_44_last_value,
  FIRST_VALUE(B_4 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_4_last_value,
  FIRST_VALUE(D_45 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_45_last_value,
  FIRST_VALUE(B_5 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_5_last_value,
  FIRST_VALUE(R_2 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_2_last_value,
  FIRST_VALUE(D_46 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_46_last_value,
  FIRST_VALUE(D_47 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_47_last_value,
  FIRST_VALUE(D_48 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_48_last_value,
  FIRST_VALUE(D_49 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_49_last_value,
  FIRST_VALUE(B_6 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_6_last_value,
  FIRST_VALUE(B_7 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_7_last_value,
  FIRST_VALUE(B_8 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_8_last_value,
  FIRST_VALUE(D_50 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_50_last_value,
  FIRST_VALUE(D_51 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_51_last_value,
  FIRST_VALUE(B_9 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_9_last_value,
  FIRST_VALUE(R_3 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_3_last_value,
  FIRST_VALUE(D_52 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_52_last_value,
  FIRST_VALUE(P_3 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS P_3_last_value,
  FIRST_VALUE(B_10 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_10_last_value,
  FIRST_VALUE(D_53 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_53_last_value,
  FIRST_VALUE(S_5 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_5_last_value,
  FIRST_VALUE(B_11 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_11_last_value,
  FIRST_VALUE(S_6 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_6_last_value,
  FIRST_VALUE(D_54 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_54_last_value,
  FIRST_VALUE(R_4 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_4_last_value,
  FIRST_VALUE(S_7 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_7_last_value,
  FIRST_VALUE(B_12 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_12_last_value,
  FIRST_VALUE(S_8 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_8_last_value,
  FIRST_VALUE(D_55 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_55_last_value,
  FIRST_VALUE(D_56 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_56_last_value,
  FIRST_VALUE(B_13 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_13_last_value,
  FIRST_VALUE(R_5 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_5_last_value,
  FIRST_VALUE(D_58 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_58_last_value,
  FIRST_VALUE(S_9 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_9_last_value,
  FIRST_VALUE(B_14 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_14_last_value,
  FIRST_VALUE(D_59 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_59_last_value,
  FIRST_VALUE(D_60 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_60_last_value,
  FIRST_VALUE(D_61 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_61_last_value,
  FIRST_VALUE(B_15 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_15_last_value,
  FIRST_VALUE(S_11 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_11_last_value,
  FIRST_VALUE(D_62 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_62_last_value,
  FIRST_VALUE(D_65 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_65_last_value,
  FIRST_VALUE(B_16 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_16_last_value,
  FIRST_VALUE(B_17 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_17_last_value,
  FIRST_VALUE(B_18 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_18_last_value,
  FIRST_VALUE(B_19 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_19_last_value,
  FIRST_VALUE(B_20 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_20_last_value,
  FIRST_VALUE(S_12 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_12_last_value,
  FIRST_VALUE(R_6 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_6_last_value,
  FIRST_VALUE(S_13 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_13_last_value,
  FIRST_VALUE(B_21 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_21_last_value,
  FIRST_VALUE(D_69 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_69_last_value,
  FIRST_VALUE(B_22 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_22_last_value,
  FIRST_VALUE(D_70 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_70_last_value,
  FIRST_VALUE(D_71 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_71_last_value,
  FIRST_VALUE(D_72 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_72_last_value,
  FIRST_VALUE(S_15 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_15_last_value,
  FIRST_VALUE(B_23 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_23_last_value,
  FIRST_VALUE(D_73 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_73_last_value,
  FIRST_VALUE(P_4 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS P_4_last_value,
  FIRST_VALUE(D_74 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_74_last_value,
  FIRST_VALUE(D_75 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_75_last_value,
  FIRST_VALUE(D_76 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_76_last_value,
  FIRST_VALUE(B_24 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_24_last_value,
  FIRST_VALUE(R_7 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_7_last_value,
  FIRST_VALUE(D_77 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_77_last_value,
  FIRST_VALUE(B_25 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_25_last_value,
  FIRST_VALUE(B_26 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_26_last_value,
  FIRST_VALUE(D_78 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_78_last_value,
  FIRST_VALUE(D_79 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_79_last_value,
  FIRST_VALUE(R_8 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_8_last_value,
  FIRST_VALUE(R_9 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_9_last_value,
  FIRST_VALUE(S_16 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_16_last_value,
  FIRST_VALUE(D_80 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_80_last_value,
  FIRST_VALUE(R_10 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_10_last_value,
  FIRST_VALUE(R_11 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_11_last_value,
  FIRST_VALUE(B_27 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_27_last_value,
  FIRST_VALUE(D_81 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_81_last_value,
  FIRST_VALUE(D_82 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_82_last_value,
  FIRST_VALUE(S_17 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_17_last_value,
  FIRST_VALUE(R_12 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_12_last_value,
  FIRST_VALUE(B_28 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_28_last_value,
  FIRST_VALUE(R_13 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_13_last_value,
  FIRST_VALUE(D_83 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_83_last_value,
  FIRST_VALUE(R_14 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_14_last_value,
  FIRST_VALUE(R_15 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_15_last_value,
  FIRST_VALUE(D_84 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_84_last_value,
  FIRST_VALUE(R_16 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_16_last_value,
  FIRST_VALUE(B_29 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_29_last_value,
  FIRST_VALUE(S_18 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_18_last_value,
  FIRST_VALUE(D_86 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_86_last_value,
  FIRST_VALUE(D_87 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_87_last_value,
  FIRST_VALUE(R_17 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_17_last_value,
  FIRST_VALUE(R_18 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_18_last_value,
  FIRST_VALUE(D_88 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_88_last_value,
  FIRST_VALUE(B_31 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_31_last_value,
  FIRST_VALUE(S_19 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_19_last_value,
  FIRST_VALUE(R_19 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_19_last_value,
  FIRST_VALUE(B_32 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_32_last_value,
  FIRST_VALUE(S_20 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_20_last_value,
  FIRST_VALUE(R_20 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_20_last_value,
  FIRST_VALUE(R_21 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_21_last_value,
  FIRST_VALUE(B_33 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_33_last_value,
  FIRST_VALUE(D_89 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_89_last_value,
  FIRST_VALUE(R_22 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_22_last_value,
  FIRST_VALUE(R_23 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_23_last_value,
  FIRST_VALUE(D_91 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_91_last_value,
  FIRST_VALUE(D_92 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_92_last_value,
  FIRST_VALUE(D_93 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_93_last_value,
  FIRST_VALUE(D_94 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_94_last_value,
  FIRST_VALUE(R_24 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_24_last_value,
  FIRST_VALUE(R_25 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_25_last_value,
  FIRST_VALUE(D_96 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_96_last_value,
  FIRST_VALUE(S_22 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_22_last_value,
  FIRST_VALUE(S_23 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_23_last_value,
  FIRST_VALUE(S_24 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_24_last_value,
  FIRST_VALUE(S_25 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_25_last_value,
  FIRST_VALUE(S_26 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_26_last_value,
  FIRST_VALUE(D_102 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_102_last_value,
  FIRST_VALUE(D_103 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_103_last_value,
  FIRST_VALUE(D_104 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_104_last_value,
  FIRST_VALUE(D_105 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_105_last_value,
  FIRST_VALUE(D_106 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_106_last_value,
  FIRST_VALUE(D_107 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_107_last_value,
  FIRST_VALUE(B_36 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_36_last_value,
  FIRST_VALUE(B_37 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_37_last_value,
  FIRST_VALUE(R_26 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_26_last_value,
  FIRST_VALUE(R_27 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_27_last_value,
  FIRST_VALUE(D_108 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_108_last_value,
  FIRST_VALUE(D_109 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_109_last_value,
  FIRST_VALUE(D_110 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_110_last_value,
  FIRST_VALUE(D_111 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_111_last_value,
  FIRST_VALUE(B_39 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_39_last_value,
  FIRST_VALUE(D_112 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_112_last_value,
  FIRST_VALUE(B_40 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_40_last_value,
  FIRST_VALUE(S_27 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS S_27_last_value,
  FIRST_VALUE(D_113 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_113_last_value,
  FIRST_VALUE(D_115 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_115_last_value,
  FIRST_VALUE(D_118 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_118_last_value,
  FIRST_VALUE(D_119 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_119_last_value,
  FIRST_VALUE(D_121 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_121_last_value,
  FIRST_VALUE(D_122 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_122_last_value,
  FIRST_VALUE(D_123 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_123_last_value,
  FIRST_VALUE(D_124 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_124_last_value,
  FIRST_VALUE(D_125 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_125_last_value,
  FIRST_VALUE(D_127 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_127_last_value,
  FIRST_VALUE(D_128 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_128_last_value,
  FIRST_VALUE(D_129 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_129_last_value,
  FIRST_VALUE(B_41 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_41_last_value,
  FIRST_VALUE(B_42 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS B_42_last_value,
  FIRST_VALUE(D_130 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_130_last_value,
  FIRST_VALUE(D_131 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_131_last_value,
  FIRST_VALUE(D_132 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_132_last_value,
  FIRST_VALUE(D_133 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_133_last_value,
  FIRST_VALUE(R_28 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS R_28_last_value,
  FIRST_VALUE(D_134 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_134_last_value,
  FIRST_VALUE(D_135 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_135_last_value,
  FIRST_VALUE(D_136 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_136_last_value,
  FIRST_VALUE(D_137 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_137_last_value,
  FIRST_VALUE(D_138 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_138_last_value,
  FIRST_VALUE(D_139 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_139_last_value,
  FIRST_VALUE(D_140 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_140_last_value,
  FIRST_VALUE(D_141 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_141_last_value,
  FIRST_VALUE(D_142 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_142_last_value,
  FIRST_VALUE(D_143 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_143_last_value,
  FIRST_VALUE(D_144 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_144_last_value,
  FIRST_VALUE(D_145 IGNORE NULLS) OVER(partition by customer_ID ORDER BY S_2 desc ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS D_145_last_value
  from `big-query-study-338516.kaggle_amex_dataset.test_data`
  ) where rown = 1
group by  customer_ID, B_30_last_value, B_38_last_value, D_114_last_value, D_116_last_value, D_117_last_value, D_120_last_value, D_126_last_value, D_63_last_value, D_64_last_value, D_66_last_value, D_68_last_value, P_2_last_value, D_39_last_value, B_1_last_value, B_2_last_value, R_1_last_value, S_3_last_value, D_41_last_value, B_3_last_value, D_42_last_value, D_43_last_value, D_44_last_value, B_4_last_value, D_45_last_value, B_5_last_value, R_2_last_value, D_46_last_value, D_47_last_value, D_48_last_value, D_49_last_value, B_6_last_value, B_7_last_value, B_8_last_value, D_50_last_value, D_51_last_value, B_9_last_value, R_3_last_value, D_52_last_value, P_3_last_value, B_10_last_value, D_53_last_value, S_5_last_value, B_11_last_value, S_6_last_value, D_54_last_value, R_4_last_value, S_7_last_value, B_12_last_value, S_8_last_value, D_55_last_value, D_56_last_value, B_13_last_value, R_5_last_value, D_58_last_value, S_9_last_value, B_14_last_value, D_59_last_value, D_60_last_value, D_61_last_value, B_15_last_value, S_11_last_value, D_62_last_value, D_65_last_value, B_16_last_value, B_17_last_value, B_18_last_value, B_19_last_value, B_20_last_value, S_12_last_value, R_6_last_value, S_13_last_value, B_21_last_value, D_69_last_value, B_22_last_value, D_70_last_value, D_71_last_value, D_72_last_value, S_15_last_value, B_23_last_value, D_73_last_value, P_4_last_value, D_74_last_value, D_75_last_value, D_76_last_value, B_24_last_value, R_7_last_value, D_77_last_value, B_25_last_value, B_26_last_value, D_78_last_value, D_79_last_value, R_8_last_value, R_9_last_value, S_16_last_value, D_80_last_value, R_10_last_value, R_11_last_value, B_27_last_value, D_81_last_value, D_82_last_value, S_17_last_value, R_12_last_value, B_28_last_value, R_13_last_value, D_83_last_value, R_14_last_value, R_15_last_value, D_84_last_value, R_16_last_value, B_29_last_value, S_18_last_value, D_86_last_value, D_87_last_value, R_17_last_value, R_18_last_value, D_88_last_value, B_31_last_value, S_19_last_value, R_19_last_value, B_32_last_value, S_20_last_value, R_20_last_value, R_21_last_value, B_33_last_value, D_89_last_value, R_22_last_value, R_23_last_value, D_91_last_value, D_92_last_value, D_93_last_value, D_94_last_value, R_24_last_value, R_25_last_value, D_96_last_value, S_22_last_value, S_23_last_value, S_24_last_value, S_25_last_value, S_26_last_value, D_102_last_value, D_103_last_value, D_104_last_value, D_105_last_value, D_106_last_value, D_107_last_value, B_36_last_value, B_37_last_value, R_26_last_value, R_27_last_value, D_108_last_value, D_109_last_value, D_110_last_value, D_111_last_value, B_39_last_value, D_112_last_value, B_40_last_value, S_27_last_value, D_113_last_value, D_115_last_value, D_118_last_value, D_119_last_value, D_121_last_value, D_122_last_value, D_123_last_value, D_124_last_value, D_125_last_value, D_127_last_value, D_128_last_value, D_129_last_value, B_41_last_value, B_42_last_value, D_130_last_value, D_131_last_value, D_132_last_value, D_133_last_value, R_28_last_value, D_134_last_value, D_135_last_value, D_136_last_value, D_137_last_value, D_138_last_value, D_139_last_value, D_140_last_value, D_141_last_value, D_142_last_value, D_143_last_value, D_144_last_value, D_145_last_value
),

num_features_agg_trends as (
  select 
  customer_ID,
  AVG(P_2_growth) as P_2_growth,
  AVG(D_39_growth) as D_39_growth,
  AVG(B_1_growth) as B_1_growth,
  AVG(B_2_growth) as B_2_growth,
  AVG(R_1_growth) as R_1_growth,
  AVG(S_3_growth) as S_3_growth,
  AVG(D_41_growth) as D_41_growth,
  AVG(B_3_growth) as B_3_growth,
  AVG(D_42_growth) as D_42_growth,
  AVG(D_43_growth) as D_43_growth,
  AVG(D_44_growth) as D_44_growth,
  AVG(B_4_growth) as B_4_growth,
  AVG(D_45_growth) as D_45_growth,
  AVG(B_5_growth) as B_5_growth,
  AVG(R_2_growth) as R_2_growth,
  AVG(D_46_growth) as D_46_growth,
  AVG(D_47_growth) as D_47_growth,
  AVG(D_48_growth) as D_48_growth,
  AVG(D_49_growth) as D_49_growth,
  AVG(B_6_growth) as B_6_growth,
  AVG(B_7_growth) as B_7_growth,
  AVG(B_8_growth) as B_8_growth,
  AVG(D_50_growth) as D_50_growth,
  AVG(D_51_growth) as D_51_growth,
  AVG(B_9_growth) as B_9_growth,
  AVG(R_3_growth) as R_3_growth,
  AVG(D_52_growth) as D_52_growth,
  AVG(P_3_growth) as P_3_growth,
  AVG(B_10_growth) as B_10_growth,
  AVG(D_53_growth) as D_53_growth,
  AVG(S_5_growth) as S_5_growth,
  AVG(B_11_growth) as B_11_growth,
  AVG(S_6_growth) as S_6_growth,
  AVG(D_54_growth) as D_54_growth,
  AVG(R_4_growth) as R_4_growth,
  AVG(S_7_growth) as S_7_growth,
  AVG(B_12_growth) as B_12_growth,
  AVG(S_8_growth) as S_8_growth,
  AVG(D_55_growth) as D_55_growth,
  AVG(D_56_growth) as D_56_growth,
  AVG(B_13_growth) as B_13_growth,
  AVG(R_5_growth) as R_5_growth,
  AVG(D_58_growth) as D_58_growth,
  AVG(S_9_growth) as S_9_growth,
  AVG(B_14_growth) as B_14_growth,
  AVG(D_59_growth) as D_59_growth,
  AVG(D_60_growth) as D_60_growth,
  AVG(D_61_growth) as D_61_growth,
  AVG(B_15_growth) as B_15_growth,
  AVG(S_11_growth) as S_11_growth,
  AVG(D_62_growth) as D_62_growth,
  AVG(D_65_growth) as D_65_growth,
  AVG(B_16_growth) as B_16_growth,
  AVG(B_17_growth) as B_17_growth,
  AVG(B_18_growth) as B_18_growth,
  AVG(B_19_growth) as B_19_growth,
  AVG(B_20_growth) as B_20_growth,
  AVG(S_12_growth) as S_12_growth,
  AVG(R_6_growth) as R_6_growth,
  AVG(S_13_growth) as S_13_growth,
  AVG(B_21_growth) as B_21_growth,
  AVG(D_69_growth) as D_69_growth,
  AVG(B_22_growth) as B_22_growth,
  AVG(D_70_growth) as D_70_growth,
  AVG(D_71_growth) as D_71_growth,
  AVG(D_72_growth) as D_72_growth,
  AVG(S_15_growth) as S_15_growth,
  AVG(B_23_growth) as B_23_growth,
  AVG(D_73_growth) as D_73_growth,
  AVG(P_4_growth) as P_4_growth,
  AVG(D_74_growth) as D_74_growth,
  AVG(D_75_growth) as D_75_growth,
  AVG(D_76_growth) as D_76_growth,
  AVG(B_24_growth) as B_24_growth,
  AVG(R_7_growth) as R_7_growth,
  AVG(D_77_growth) as D_77_growth,
  AVG(B_25_growth) as B_25_growth,
  AVG(B_26_growth) as B_26_growth,
  AVG(D_78_growth) as D_78_growth,
  AVG(D_79_growth) as D_79_growth,
  AVG(R_8_growth) as R_8_growth,
  AVG(R_9_growth) as R_9_growth,
  AVG(S_16_growth) as S_16_growth,
  AVG(D_80_growth) as D_80_growth,
  AVG(R_10_growth) as R_10_growth,
  AVG(R_11_growth) as R_11_growth,
  AVG(B_27_growth) as B_27_growth,
  AVG(D_81_growth) as D_81_growth,
  AVG(D_82_growth) as D_82_growth,
  AVG(S_17_growth) as S_17_growth,
  AVG(R_12_growth) as R_12_growth,
  AVG(B_28_growth) as B_28_growth,
  AVG(R_13_growth) as R_13_growth,
  AVG(D_83_growth) as D_83_growth,
  AVG(R_14_growth) as R_14_growth,
  AVG(R_15_growth) as R_15_growth,
  AVG(D_84_growth) as D_84_growth,
  AVG(R_16_growth) as R_16_growth,
  AVG(B_29_growth) as B_29_growth,
  AVG(S_18_growth) as S_18_growth,
  AVG(D_86_growth) as D_86_growth,
  AVG(D_87_growth) as D_87_growth,
  AVG(R_17_growth) as R_17_growth,
  AVG(R_18_growth) as R_18_growth,
  AVG(D_88_growth) as D_88_growth,
  AVG(B_31_growth) as B_31_growth,
  AVG(S_19_growth) as S_19_growth,
  AVG(R_19_growth) as R_19_growth,
  AVG(B_32_growth) as B_32_growth,
  AVG(S_20_growth) as S_20_growth,
  AVG(R_20_growth) as R_20_growth,
  AVG(R_21_growth) as R_21_growth,
  AVG(B_33_growth) as B_33_growth,
  AVG(D_89_growth) as D_89_growth,
  AVG(R_22_growth) as R_22_growth,
  AVG(R_23_growth) as R_23_growth,
  AVG(D_91_growth) as D_91_growth,
  AVG(D_92_growth) as D_92_growth,
  AVG(D_93_growth) as D_93_growth,
  AVG(D_94_growth) as D_94_growth,
  AVG(R_24_growth) as R_24_growth,
  AVG(R_25_growth) as R_25_growth,
  AVG(D_96_growth) as D_96_growth,
  AVG(S_22_growth) as S_22_growth,
  AVG(S_23_growth) as S_23_growth,
  AVG(S_24_growth) as S_24_growth,
  AVG(S_25_growth) as S_25_growth,
  AVG(S_26_growth) as S_26_growth,
  AVG(D_102_growth) as D_102_growth,
  AVG(D_103_growth) as D_103_growth,
  AVG(D_104_growth) as D_104_growth,
  AVG(D_105_growth) as D_105_growth,
  AVG(D_106_growth) as D_106_growth,
  AVG(D_107_growth) as D_107_growth,
  AVG(B_36_growth) as B_36_growth,
  AVG(B_37_growth) as B_37_growth,
  AVG(R_26_growth) as R_26_growth,
  AVG(R_27_growth) as R_27_growth,
  AVG(D_108_growth) as D_108_growth,
  AVG(D_109_growth) as D_109_growth,
  AVG(D_110_growth) as D_110_growth,
  AVG(D_111_growth) as D_111_growth,
  AVG(B_39_growth) as B_39_growth,
  AVG(D_112_growth) as D_112_growth,
  AVG(B_40_growth) as B_40_growth,
  AVG(S_27_growth) as S_27_growth,
  AVG(D_113_growth) as D_113_growth,
  AVG(D_115_growth) as D_115_growth,
  AVG(D_118_growth) as D_118_growth,
  AVG(D_119_growth) as D_119_growth,
  AVG(D_121_growth) as D_121_growth,
  AVG(D_122_growth) as D_122_growth,
  AVG(D_123_growth) as D_123_growth,
  AVG(D_124_growth) as D_124_growth,
  AVG(D_125_growth) as D_125_growth,
  AVG(D_127_growth) as D_127_growth,
  AVG(D_128_growth) as D_128_growth,
  AVG(D_129_growth) as D_129_growth,
  AVG(B_41_growth) as B_41_growth,
  AVG(B_42_growth) as B_42_growth,
  AVG(D_130_growth) as D_130_growth,
  AVG(D_131_growth) as D_131_growth,
  AVG(D_132_growth) as D_132_growth,
  AVG(D_133_growth) as D_133_growth,
  AVG(R_28_growth) as R_28_growth,
  AVG(D_134_growth) as D_134_growth,
  AVG(D_135_growth) as D_135_growth,
  AVG(D_136_growth) as D_136_growth,
  AVG(D_137_growth) as D_137_growth,
  AVG(D_138_growth) as D_138_growth,
  AVG(D_139_growth) as D_139_growth,
  AVG(D_140_growth) as D_140_growth,
  AVG(D_141_growth) as D_141_growth,
  AVG(D_142_growth) as D_142_growth,
  AVG(D_143_growth) as D_143_growth,
  AVG(D_144_growth) as D_144_growth,
  AVG(D_145_growth) as D_145_growth
  from num_features_trends
  group by customer_ID
),



num_features_agg_trends_max AS (
  select 
  customer_ID,
  MAX(P_2_growth) as P_2_growth_max,
  MAX(D_39_growth) as D_39_growth_max,
  MAX(B_1_growth) as B_1_growth_max,
  MAX(B_2_growth) as B_2_growth_max,
  MAX(R_1_growth) as R_1_growth_max,
  MAX(S_3_growth) as S_3_growth_max,
  MAX(D_41_growth) as D_41_growth_max,
  MAX(B_3_growth) as B_3_growth_max,
  MAX(D_42_growth) as D_42_growth_max,
  MAX(D_43_growth) as D_43_growth_max,
  MAX(D_44_growth) as D_44_growth_max,
  MAX(B_4_growth) as B_4_growth_max,
  MAX(D_45_growth) as D_45_growth_max,
  MAX(B_5_growth) as B_5_growth_max,
  MAX(R_2_growth) as R_2_growth_max,
  MAX(D_46_growth) as D_46_growth_max,
  MAX(D_47_growth) as D_47_growth_max,
  MAX(D_48_growth) as D_48_growth_max,
  MAX(D_49_growth) as D_49_growth_max,
  MAX(B_6_growth) as B_6_growth_max,
  MAX(B_7_growth) as B_7_growth_max,
  MAX(B_8_growth) as B_8_growth_max,
  MAX(D_50_growth) as D_50_growth_max,
  MAX(D_51_growth) as D_51_growth_max,
  MAX(B_9_growth) as B_9_growth_max,
  MAX(R_3_growth) as R_3_growth_max,
  MAX(D_52_growth) as D_52_growth_max,
  MAX(P_3_growth) as P_3_growth_max,
  MAX(B_10_growth) as B_10_growth_max,
  MAX(D_53_growth) as D_53_growth_max,
  MAX(S_5_growth) as S_5_growth_max,
  MAX(B_11_growth) as B_11_growth_max,
  MAX(S_6_growth) as S_6_growth_max,
  MAX(D_54_growth) as D_54_growth_max,
  MAX(R_4_growth) as R_4_growth_max,
  MAX(S_7_growth) as S_7_growth_max,
  MAX(B_12_growth) as B_12_growth_max,
  MAX(S_8_growth) as S_8_growth_max,
  MAX(D_55_growth) as D_55_growth_max,
  MAX(D_56_growth) as D_56_growth_max,
  MAX(B_13_growth) as B_13_growth_max,
  MAX(R_5_growth) as R_5_growth_max,
  MAX(D_58_growth) as D_58_growth_max,
  MAX(S_9_growth) as S_9_growth_max,
  MAX(B_14_growth) as B_14_growth_max,
  MAX(D_59_growth) as D_59_growth_max,
  MAX(D_60_growth) as D_60_growth_max,
  MAX(D_61_growth) as D_61_growth_max,
  MAX(B_15_growth) as B_15_growth_max,
  MAX(S_11_growth) as S_11_growth_max,
  MAX(D_62_growth) as D_62_growth_max,
  MAX(D_65_growth) as D_65_growth_max,
  MAX(B_16_growth) as B_16_growth_max,
  MAX(B_17_growth) as B_17_growth_max,
  MAX(B_18_growth) as B_18_growth_max,
  MAX(B_19_growth) as B_19_growth_max,
  MAX(B_20_growth) as B_20_growth_max,
  MAX(S_12_growth) as S_12_growth_max,
  MAX(R_6_growth) as R_6_growth_max,
  MAX(S_13_growth) as S_13_growth_max,
  MAX(B_21_growth) as B_21_growth_max,
  MAX(D_69_growth) as D_69_growth_max,
  MAX(B_22_growth) as B_22_growth_max,
  MAX(D_70_growth) as D_70_growth_max,
  MAX(D_71_growth) as D_71_growth_max,
  MAX(D_72_growth) as D_72_growth_max,
  MAX(S_15_growth) as S_15_growth_max,
  MAX(B_23_growth) as B_23_growth_max,
  MAX(D_73_growth) as D_73_growth_max,
  MAX(P_4_growth) as P_4_growth_max,
  MAX(D_74_growth) as D_74_growth_max,
  MAX(D_75_growth) as D_75_growth_max,
  MAX(D_76_growth) as D_76_growth_max,
  MAX(B_24_growth) as B_24_growth_max,
  MAX(R_7_growth) as R_7_growth_max,
  MAX(D_77_growth) as D_77_growth_max,
  MAX(B_25_growth) as B_25_growth_max,
  MAX(B_26_growth) as B_26_growth_max,
  MAX(D_78_growth) as D_78_growth_max,
  MAX(D_79_growth) as D_79_growth_max,
  MAX(R_8_growth) as R_8_growth_max,
  MAX(R_9_growth) as R_9_growth_max,
  MAX(S_16_growth) as S_16_growth_max,
  MAX(D_80_growth) as D_80_growth_max,
  MAX(R_10_growth) as R_10_growth_max,
  MAX(R_11_growth) as R_11_growth_max,
  MAX(B_27_growth) as B_27_growth_max,
  MAX(D_81_growth) as D_81_growth_max,
  MAX(D_82_growth) as D_82_growth_max,
  MAX(S_17_growth) as S_17_growth_max,
  MAX(R_12_growth) as R_12_growth_max,
  MAX(B_28_growth) as B_28_growth_max,
  MAX(R_13_growth) as R_13_growth_max,
  MAX(D_83_growth) as D_83_growth_max,
  MAX(R_14_growth) as R_14_growth_max,
  MAX(R_15_growth) as R_15_growth_max,
  MAX(D_84_growth) as D_84_growth_max,
  MAX(R_16_growth) as R_16_growth_max,
  MAX(B_29_growth) as B_29_growth_max,
  MAX(S_18_growth) as S_18_growth_max,
  MAX(D_86_growth) as D_86_growth_max,
  MAX(D_87_growth) as D_87_growth_max,
  MAX(R_17_growth) as R_17_growth_max,
  MAX(R_18_growth) as R_18_growth_max,
  MAX(D_88_growth) as D_88_growth_max,
  MAX(B_31_growth) as B_31_growth_max,
  MAX(S_19_growth) as S_19_growth_max,
  MAX(R_19_growth) as R_19_growth_max,
  MAX(B_32_growth) as B_32_growth_max,
  MAX(S_20_growth) as S_20_growth_max,
  MAX(R_20_growth) as R_20_growth_max,
  MAX(R_21_growth) as R_21_growth_max,
  MAX(B_33_growth) as B_33_growth_max,
  MAX(D_89_growth) as D_89_growth_max,
  MAX(R_22_growth) as R_22_growth_max,
  MAX(R_23_growth) as R_23_growth_max,
  MAX(D_91_growth) as D_91_growth_max,
  MAX(D_92_growth) as D_92_growth_max,
  MAX(D_93_growth) as D_93_growth_max,
  MAX(D_94_growth) as D_94_growth_max,
  MAX(R_24_growth) as R_24_growth_max,
  MAX(R_25_growth) as R_25_growth_max,
  MAX(D_96_growth) as D_96_growth_max,
  MAX(S_22_growth) as S_22_growth_max,
  MAX(S_23_growth) as S_23_growth_max,
  MAX(S_24_growth) as S_24_growth_max,
  MAX(S_25_growth) as S_25_growth_max,
  MAX(S_26_growth) as S_26_growth_max,
  MAX(D_102_growth) as D_102_growth_max,
  MAX(D_103_growth) as D_103_growth_max,
  MAX(D_104_growth) as D_104_growth_max,
  MAX(D_105_growth) as D_105_growth_max,
  MAX(D_106_growth) as D_106_growth_max,
  MAX(D_107_growth) as D_107_growth_max,
  MAX(B_36_growth) as B_36_growth_max,
  MAX(B_37_growth) as B_37_growth_max,
  MAX(R_26_growth) as R_26_growth_max,
  MAX(R_27_growth) as R_27_growth_max,
  MAX(D_108_growth) as D_108_growth_max,
  MAX(D_109_growth) as D_109_growth_max,
  MAX(D_110_growth) as D_110_growth_max,
  MAX(D_111_growth) as D_111_growth_max,
  MAX(B_39_growth) as B_39_growth_max,
  MAX(D_112_growth) as D_112_growth_max,
  MAX(B_40_growth) as B_40_growth_max,
  MAX(S_27_growth) as S_27_growth_max,
  MAX(D_113_growth) as D_113_growth_max,
  MAX(D_115_growth) as D_115_growth_max,
  MAX(D_118_growth) as D_118_growth_max,
  MAX(D_119_growth) as D_119_growth_max,
  MAX(D_121_growth) as D_121_growth_max,
  MAX(D_122_growth) as D_122_growth_max,
  MAX(D_123_growth) as D_123_growth_max,
  MAX(D_124_growth) as D_124_growth_max,
  MAX(D_125_growth) as D_125_growth_max,
  MAX(D_127_growth) as D_127_growth_max,
  MAX(D_128_growth) as D_128_growth_max,
  MAX(D_129_growth) as D_129_growth_max,
  MAX(B_41_growth) as B_41_growth_max,
  MAX(B_42_growth) as B_42_growth_max,
  MAX(D_130_growth) as D_130_growth_max,
  MAX(D_131_growth) as D_131_growth_max,
  MAX(D_132_growth) as D_132_growth_max,
  MAX(D_133_growth) as D_133_growth_max,
  MAX(R_28_growth) as R_28_growth_max,
  MAX(D_134_growth) as D_134_growth_max,
  MAX(D_135_growth) as D_135_growth_max,
  MAX(D_136_growth) as D_136_growth_max,
  MAX(D_137_growth) as D_137_growth_max,
  MAX(D_138_growth) as D_138_growth_max,
  MAX(D_139_growth) as D_139_growth_max,
  MAX(D_140_growth) as D_140_growth_max,
  MAX(D_141_growth) as D_141_growth_max,
  MAX(D_142_growth) as D_142_growth_max,
  MAX(D_143_growth) as D_143_growth_max,
  MAX(D_144_growth) as D_144_growth_max,
  MAX(D_145_growth) as D_145_growth_max
  from num_features_trends
  group by customer_ID
),


num_agg_features_trends as (
  select 
  customer_ID,
  AVG(P_2) as P_2_avg, STDDEV(P_2) as P_2_stddev, MIN(P_2) as P_2_min, MAX(P_2) as P_2_max,
  AVG(D_39) as D_39_avg, STDDEV(D_39) as D_39_stddev, MIN(D_39) as D_39_min, MAX(D_39) as D_39_max,
  AVG(B_1) as B_1_avg, STDDEV(B_1) as B_1_stddev, MIN(B_1) as B_1_min, MAX(B_1) as B_1_max,
  AVG(B_2) as B_2_avg, STDDEV(B_2) as B_2_stddev, MIN(B_2) as B_2_min, MAX(B_2) as B_2_max,
  AVG(R_1) as R_1_avg, STDDEV(R_1) as R_1_stddev, MIN(R_1) as R_1_min, MAX(R_1) as R_1_max,
  AVG(S_3) as S_3_avg, STDDEV(S_3) as S_3_stddev, MIN(S_3) as S_3_min, MAX(S_3) as S_3_max,
  AVG(D_41) as D_41_avg, STDDEV(D_41) as D_41_stddev, MIN(D_41) as D_41_min, MAX(D_41) as D_41_max,
  AVG(B_3) as B_3_avg, STDDEV(B_3) as B_3_stddev, MIN(B_3) as B_3_min, MAX(B_3) as B_3_max,
  AVG(D_42) as D_42_avg, STDDEV(D_42) as D_42_stddev, MIN(D_42) as D_42_min, MAX(D_42) as D_42_max,
  AVG(D_43) as D_43_avg, STDDEV(D_43) as D_43_stddev, MIN(D_43) as D_43_min, MAX(D_43) as D_43_max,
  AVG(D_44) as D_44_avg, STDDEV(D_44) as D_44_stddev, MIN(D_44) as D_44_min, MAX(D_44) as D_44_max,
  AVG(B_4) as B_4_avg, STDDEV(B_4) as B_4_stddev, MIN(B_4) as B_4_min, MAX(B_4) as B_4_max,
  AVG(D_45) as D_45_avg, STDDEV(D_45) as D_45_stddev, MIN(D_45) as D_45_min, MAX(D_45) as D_45_max,
  AVG(B_5) as B_5_avg, STDDEV(B_5) as B_5_stddev, MIN(B_5) as B_5_min, MAX(B_5) as B_5_max,
  AVG(R_2) as R_2_avg, STDDEV(R_2) as R_2_stddev, MIN(R_2) as R_2_min, MAX(R_2) as R_2_max,
  AVG(D_46) as D_46_avg, STDDEV(D_46) as D_46_stddev, MIN(D_46) as D_46_min, MAX(D_46) as D_46_max,
  AVG(D_47) as D_47_avg, STDDEV(D_47) as D_47_stddev, MIN(D_47) as D_47_min, MAX(D_47) as D_47_max,
  AVG(D_48) as D_48_avg, STDDEV(D_48) as D_48_stddev, MIN(D_48) as D_48_min, MAX(D_48) as D_48_max,
  AVG(D_49) as D_49_avg, STDDEV(D_49) as D_49_stddev, MIN(D_49) as D_49_min, MAX(D_49) as D_49_max,
  AVG(B_6) as B_6_avg, STDDEV(B_6) as B_6_stddev, MIN(B_6) as B_6_min, MAX(B_6) as B_6_max,
  AVG(B_7) as B_7_avg, STDDEV(B_7) as B_7_stddev, MIN(B_7) as B_7_min, MAX(B_7) as B_7_max,
  AVG(B_8) as B_8_avg, STDDEV(B_8) as B_8_stddev, MIN(B_8) as B_8_min, MAX(B_8) as B_8_max,
  AVG(D_50) as D_50_avg, STDDEV(D_50) as D_50_stddev, MIN(D_50) as D_50_min, MAX(D_50) as D_50_max,
  AVG(D_51) as D_51_avg, STDDEV(D_51) as D_51_stddev, MIN(D_51) as D_51_min, MAX(D_51) as D_51_max,
  AVG(B_9) as B_9_avg, STDDEV(B_9) as B_9_stddev, MIN(B_9) as B_9_min, MAX(B_9) as B_9_max,
  AVG(R_3) as R_3_avg, STDDEV(R_3) as R_3_stddev, MIN(R_3) as R_3_min, MAX(R_3) as R_3_max,
  AVG(D_52) as D_52_avg, STDDEV(D_52) as D_52_stddev, MIN(D_52) as D_52_min, MAX(D_52) as D_52_max,
  AVG(P_3) as P_3_avg, STDDEV(P_3) as P_3_stddev, MIN(P_3) as P_3_min, MAX(P_3) as P_3_max,
  AVG(B_10) as B_10_avg, STDDEV(B_10) as B_10_stddev, MIN(B_10) as B_10_min, MAX(B_10) as B_10_max,
  AVG(D_53) as D_53_avg, STDDEV(D_53) as D_53_stddev, MIN(D_53) as D_53_min, MAX(D_53) as D_53_max,
  AVG(S_5) as S_5_avg, STDDEV(S_5) as S_5_stddev, MIN(S_5) as S_5_min, MAX(S_5) as S_5_max,
  AVG(B_11) as B_11_avg, STDDEV(B_11) as B_11_stddev, MIN(B_11) as B_11_min, MAX(B_11) as B_11_max,
  AVG(S_6) as S_6_avg, STDDEV(S_6) as S_6_stddev, MIN(S_6) as S_6_min, MAX(S_6) as S_6_max,
  AVG(D_54) as D_54_avg, STDDEV(D_54) as D_54_stddev, MIN(D_54) as D_54_min, MAX(D_54) as D_54_max,
  AVG(R_4) as R_4_avg, STDDEV(R_4) as R_4_stddev, MIN(R_4) as R_4_min, MAX(R_4) as R_4_max,
  AVG(S_7) as S_7_avg, STDDEV(S_7) as S_7_stddev, MIN(S_7) as S_7_min, MAX(S_7) as S_7_max,
  AVG(B_12) as B_12_avg, STDDEV(B_12) as B_12_stddev, MIN(B_12) as B_12_min, MAX(B_12) as B_12_max,
  AVG(S_8) as S_8_avg, STDDEV(S_8) as S_8_stddev, MIN(S_8) as S_8_min, MAX(S_8) as S_8_max,
  AVG(D_55) as D_55_avg, STDDEV(D_55) as D_55_stddev, MIN(D_55) as D_55_min, MAX(D_55) as D_55_max,
  AVG(D_56) as D_56_avg, STDDEV(D_56) as D_56_stddev, MIN(D_56) as D_56_min, MAX(D_56) as D_56_max,
  AVG(B_13) as B_13_avg, STDDEV(B_13) as B_13_stddev, MIN(B_13) as B_13_min, MAX(B_13) as B_13_max,
  AVG(R_5) as R_5_avg, STDDEV(R_5) as R_5_stddev, MIN(R_5) as R_5_min, MAX(R_5) as R_5_max,
  AVG(D_58) as D_58_avg, STDDEV(D_58) as D_58_stddev, MIN(D_58) as D_58_min, MAX(D_58) as D_58_max,
  AVG(S_9) as S_9_avg, STDDEV(S_9) as S_9_stddev, MIN(S_9) as S_9_min, MAX(S_9) as S_9_max,
  AVG(B_14) as B_14_avg, STDDEV(B_14) as B_14_stddev, MIN(B_14) as B_14_min, MAX(B_14) as B_14_max,
  AVG(D_59) as D_59_avg, STDDEV(D_59) as D_59_stddev, MIN(D_59) as D_59_min, MAX(D_59) as D_59_max,
  AVG(D_60) as D_60_avg, STDDEV(D_60) as D_60_stddev, MIN(D_60) as D_60_min, MAX(D_60) as D_60_max,
  AVG(D_61) as D_61_avg, STDDEV(D_61) as D_61_stddev, MIN(D_61) as D_61_min, MAX(D_61) as D_61_max,
  AVG(B_15) as B_15_avg, STDDEV(B_15) as B_15_stddev, MIN(B_15) as B_15_min, MAX(B_15) as B_15_max,
  AVG(S_11) as S_11_avg, STDDEV(S_11) as S_11_stddev, MIN(S_11) as S_11_min, MAX(S_11) as S_11_max,
  AVG(D_62) as D_62_avg, STDDEV(D_62) as D_62_stddev, MIN(D_62) as D_62_min, MAX(D_62) as D_62_max,
  AVG(D_65) as D_65_avg, STDDEV(D_65) as D_65_stddev, MIN(D_65) as D_65_min, MAX(D_65) as D_65_max,
  AVG(B_16) as B_16_avg, STDDEV(B_16) as B_16_stddev, MIN(B_16) as B_16_min, MAX(B_16) as B_16_max,
  AVG(B_17) as B_17_avg, STDDEV(B_17) as B_17_stddev, MIN(B_17) as B_17_min, MAX(B_17) as B_17_max,
  AVG(B_18) as B_18_avg, STDDEV(B_18) as B_18_stddev, MIN(B_18) as B_18_min, MAX(B_18) as B_18_max,
  AVG(B_19) as B_19_avg, STDDEV(B_19) as B_19_stddev, MIN(B_19) as B_19_min, MAX(B_19) as B_19_max,
  AVG(B_20) as B_20_avg, STDDEV(B_20) as B_20_stddev, MIN(B_20) as B_20_min, MAX(B_20) as B_20_max,
  AVG(S_12) as S_12_avg, STDDEV(S_12) as S_12_stddev, MIN(S_12) as S_12_min, MAX(S_12) as S_12_max,
  AVG(R_6) as R_6_avg, STDDEV(R_6) as R_6_stddev, MIN(R_6) as R_6_min, MAX(R_6) as R_6_max,
  AVG(S_13) as S_13_avg, STDDEV(S_13) as S_13_stddev, MIN(S_13) as S_13_min, MAX(S_13) as S_13_max,
  AVG(B_21) as B_21_avg, STDDEV(B_21) as B_21_stddev, MIN(B_21) as B_21_min, MAX(B_21) as B_21_max,
  AVG(D_69) as D_69_avg, STDDEV(D_69) as D_69_stddev, MIN(D_69) as D_69_min, MAX(D_69) as D_69_max,
  AVG(B_22) as B_22_avg, STDDEV(B_22) as B_22_stddev, MIN(B_22) as B_22_min, MAX(B_22) as B_22_max,
  AVG(D_70) as D_70_avg, STDDEV(D_70) as D_70_stddev, MIN(D_70) as D_70_min, MAX(D_70) as D_70_max,
  AVG(D_71) as D_71_avg, STDDEV(D_71) as D_71_stddev, MIN(D_71) as D_71_min, MAX(D_71) as D_71_max,
  AVG(D_72) as D_72_avg, STDDEV(D_72) as D_72_stddev, MIN(D_72) as D_72_min, MAX(D_72) as D_72_max,
  AVG(S_15) as S_15_avg, STDDEV(S_15) as S_15_stddev, MIN(S_15) as S_15_min, MAX(S_15) as S_15_max,
  AVG(B_23) as B_23_avg, STDDEV(B_23) as B_23_stddev, MIN(B_23) as B_23_min, MAX(B_23) as B_23_max,
  AVG(D_73) as D_73_avg, STDDEV(D_73) as D_73_stddev, MIN(D_73) as D_73_min, MAX(D_73) as D_73_max,
  AVG(P_4) as P_4_avg, STDDEV(P_4) as P_4_stddev, MIN(P_4) as P_4_min, MAX(P_4) as P_4_max,
  AVG(D_74) as D_74_avg, STDDEV(D_74) as D_74_stddev, MIN(D_74) as D_74_min, MAX(D_74) as D_74_max,
  AVG(D_75) as D_75_avg, STDDEV(D_75) as D_75_stddev, MIN(D_75) as D_75_min, MAX(D_75) as D_75_max,
  AVG(D_76) as D_76_avg, STDDEV(D_76) as D_76_stddev, MIN(D_76) as D_76_min, MAX(D_76) as D_76_max,
  AVG(B_24) as B_24_avg, STDDEV(B_24) as B_24_stddev, MIN(B_24) as B_24_min, MAX(B_24) as B_24_max,
  AVG(R_7) as R_7_avg, STDDEV(R_7) as R_7_stddev, MIN(R_7) as R_7_min, MAX(R_7) as R_7_max,
  AVG(D_77) as D_77_avg, STDDEV(D_77) as D_77_stddev, MIN(D_77) as D_77_min, MAX(D_77) as D_77_max,
  AVG(B_25) as B_25_avg, STDDEV(B_25) as B_25_stddev, MIN(B_25) as B_25_min, MAX(B_25) as B_25_max,
  AVG(B_26) as B_26_avg, STDDEV(B_26) as B_26_stddev, MIN(B_26) as B_26_min, MAX(B_26) as B_26_max,
  AVG(D_78) as D_78_avg, STDDEV(D_78) as D_78_stddev, MIN(D_78) as D_78_min, MAX(D_78) as D_78_max,
  AVG(D_79) as D_79_avg, STDDEV(D_79) as D_79_stddev, MIN(D_79) as D_79_min, MAX(D_79) as D_79_max,
  AVG(R_8) as R_8_avg, STDDEV(R_8) as R_8_stddev, MIN(R_8) as R_8_min, MAX(R_8) as R_8_max,
  AVG(R_9) as R_9_avg, STDDEV(R_9) as R_9_stddev, MIN(R_9) as R_9_min, MAX(R_9) as R_9_max,
  AVG(S_16) as S_16_avg, STDDEV(S_16) as S_16_stddev, MIN(S_16) as S_16_min, MAX(S_16) as S_16_max,
  AVG(D_80) as D_80_avg, STDDEV(D_80) as D_80_stddev, MIN(D_80) as D_80_min, MAX(D_80) as D_80_max,
  AVG(R_10) as R_10_avg, STDDEV(R_10) as R_10_stddev, MIN(R_10) as R_10_min, MAX(R_10) as R_10_max,
  AVG(R_11) as R_11_avg, STDDEV(R_11) as R_11_stddev, MIN(R_11) as R_11_min, MAX(R_11) as R_11_max,
  AVG(B_27) as B_27_avg, STDDEV(B_27) as B_27_stddev, MIN(B_27) as B_27_min, MAX(B_27) as B_27_max,
  AVG(D_81) as D_81_avg, STDDEV(D_81) as D_81_stddev, MIN(D_81) as D_81_min, MAX(D_81) as D_81_max,
  AVG(D_82) as D_82_avg, STDDEV(D_82) as D_82_stddev, MIN(D_82) as D_82_min, MAX(D_82) as D_82_max,
  AVG(S_17) as S_17_avg, STDDEV(S_17) as S_17_stddev, MIN(S_17) as S_17_min, MAX(S_17) as S_17_max,
  AVG(R_12) as R_12_avg, STDDEV(R_12) as R_12_stddev, MIN(R_12) as R_12_min, MAX(R_12) as R_12_max,
  AVG(B_28) as B_28_avg, STDDEV(B_28) as B_28_stddev, MIN(B_28) as B_28_min, MAX(B_28) as B_28_max,
  AVG(R_13) as R_13_avg, STDDEV(R_13) as R_13_stddev, MIN(R_13) as R_13_min, MAX(R_13) as R_13_max,
  AVG(D_83) as D_83_avg, STDDEV(D_83) as D_83_stddev, MIN(D_83) as D_83_min, MAX(D_83) as D_83_max,
  AVG(R_14) as R_14_avg, STDDEV(R_14) as R_14_stddev, MIN(R_14) as R_14_min, MAX(R_14) as R_14_max,
  AVG(R_15) as R_15_avg, STDDEV(R_15) as R_15_stddev, MIN(R_15) as R_15_min, MAX(R_15) as R_15_max,
  AVG(D_84) as D_84_avg, STDDEV(D_84) as D_84_stddev, MIN(D_84) as D_84_min, MAX(D_84) as D_84_max,
  AVG(R_16) as R_16_avg, STDDEV(R_16) as R_16_stddev, MIN(R_16) as R_16_min, MAX(R_16) as R_16_max,
  AVG(B_29) as B_29_avg, STDDEV(B_29) as B_29_stddev, MIN(B_29) as B_29_min, MAX(B_29) as B_29_max,
  AVG(S_18) as S_18_avg, STDDEV(S_18) as S_18_stddev, MIN(S_18) as S_18_min, MAX(S_18) as S_18_max,
  AVG(D_86) as D_86_avg, STDDEV(D_86) as D_86_stddev, MIN(D_86) as D_86_min, MAX(D_86) as D_86_max,
  AVG(D_87) as D_87_avg, STDDEV(D_87) as D_87_stddev, MIN(D_87) as D_87_min, MAX(D_87) as D_87_max,
  AVG(R_17) as R_17_avg, STDDEV(R_17) as R_17_stddev, MIN(R_17) as R_17_min, MAX(R_17) as R_17_max,
  AVG(R_18) as R_18_avg, STDDEV(R_18) as R_18_stddev, MIN(R_18) as R_18_min, MAX(R_18) as R_18_max,
  AVG(D_88) as D_88_avg, STDDEV(D_88) as D_88_stddev, MIN(D_88) as D_88_min, MAX(D_88) as D_88_max,
  AVG(B_31) as B_31_avg, STDDEV(B_31) as B_31_stddev, MIN(B_31) as B_31_min, MAX(B_31) as B_31_max,
  AVG(S_19) as S_19_avg, STDDEV(S_19) as S_19_stddev, MIN(S_19) as S_19_min, MAX(S_19) as S_19_max,
  AVG(R_19) as R_19_avg, STDDEV(R_19) as R_19_stddev, MIN(R_19) as R_19_min, MAX(R_19) as R_19_max,
  AVG(B_32) as B_32_avg, STDDEV(B_32) as B_32_stddev, MIN(B_32) as B_32_min, MAX(B_32) as B_32_max,
  AVG(S_20) as S_20_avg, STDDEV(S_20) as S_20_stddev, MIN(S_20) as S_20_min, MAX(S_20) as S_20_max,
  AVG(R_20) as R_20_avg, STDDEV(R_20) as R_20_stddev, MIN(R_20) as R_20_min, MAX(R_20) as R_20_max,
  AVG(R_21) as R_21_avg, STDDEV(R_21) as R_21_stddev, MIN(R_21) as R_21_min, MAX(R_21) as R_21_max,
  AVG(B_33) as B_33_avg, STDDEV(B_33) as B_33_stddev, MIN(B_33) as B_33_min, MAX(B_33) as B_33_max,
  AVG(D_89) as D_89_avg, STDDEV(D_89) as D_89_stddev, MIN(D_89) as D_89_min, MAX(D_89) as D_89_max,
  AVG(R_22) as R_22_avg, STDDEV(R_22) as R_22_stddev, MIN(R_22) as R_22_min, MAX(R_22) as R_22_max,
  AVG(R_23) as R_23_avg, STDDEV(R_23) as R_23_stddev, MIN(R_23) as R_23_min, MAX(R_23) as R_23_max,
  AVG(D_91) as D_91_avg, STDDEV(D_91) as D_91_stddev, MIN(D_91) as D_91_min, MAX(D_91) as D_91_max,
  AVG(D_92) as D_92_avg, STDDEV(D_92) as D_92_stddev, MIN(D_92) as D_92_min, MAX(D_92) as D_92_max,
  AVG(D_93) as D_93_avg, STDDEV(D_93) as D_93_stddev, MIN(D_93) as D_93_min, MAX(D_93) as D_93_max,
  AVG(D_94) as D_94_avg, STDDEV(D_94) as D_94_stddev, MIN(D_94) as D_94_min, MAX(D_94) as D_94_max,
  AVG(R_24) as R_24_avg, STDDEV(R_24) as R_24_stddev, MIN(R_24) as R_24_min, MAX(R_24) as R_24_max,
  AVG(R_25) as R_25_avg, STDDEV(R_25) as R_25_stddev, MIN(R_25) as R_25_min, MAX(R_25) as R_25_max,
  AVG(D_96) as D_96_avg, STDDEV(D_96) as D_96_stddev, MIN(D_96) as D_96_min, MAX(D_96) as D_96_max,
  AVG(S_22) as S_22_avg, STDDEV(S_22) as S_22_stddev, MIN(S_22) as S_22_min, MAX(S_22) as S_22_max,
  AVG(S_23) as S_23_avg, STDDEV(S_23) as S_23_stddev, MIN(S_23) as S_23_min, MAX(S_23) as S_23_max,
  AVG(S_24) as S_24_avg, STDDEV(S_24) as S_24_stddev, MIN(S_24) as S_24_min, MAX(S_24) as S_24_max,
  AVG(S_25) as S_25_avg, STDDEV(S_25) as S_25_stddev, MIN(S_25) as S_25_min, MAX(S_25) as S_25_max,
  AVG(S_26) as S_26_avg, STDDEV(S_26) as S_26_stddev, MIN(S_26) as S_26_min, MAX(S_26) as S_26_max,
  AVG(D_102) as D_102_avg, STDDEV(D_102) as D_102_stddev, MIN(D_102) as D_102_min, MAX(D_102) as D_102_max,
  AVG(D_103) as D_103_avg, STDDEV(D_103) as D_103_stddev, MIN(D_103) as D_103_min, MAX(D_103) as D_103_max,
  AVG(D_104) as D_104_avg, STDDEV(D_104) as D_104_stddev, MIN(D_104) as D_104_min, MAX(D_104) as D_104_max,
  AVG(D_105) as D_105_avg, STDDEV(D_105) as D_105_stddev, MIN(D_105) as D_105_min, MAX(D_105) as D_105_max,
  AVG(D_106) as D_106_avg, STDDEV(D_106) as D_106_stddev, MIN(D_106) as D_106_min, MAX(D_106) as D_106_max,
  AVG(D_107) as D_107_avg, STDDEV(D_107) as D_107_stddev, MIN(D_107) as D_107_min, MAX(D_107) as D_107_max,
  AVG(B_36) as B_36_avg, STDDEV(B_36) as B_36_stddev, MIN(B_36) as B_36_min, MAX(B_36) as B_36_max,
  AVG(B_37) as B_37_avg, STDDEV(B_37) as B_37_stddev, MIN(B_37) as B_37_min, MAX(B_37) as B_37_max,
  AVG(R_26) as R_26_avg, STDDEV(R_26) as R_26_stddev, MIN(R_26) as R_26_min, MAX(R_26) as R_26_max,
  AVG(R_27) as R_27_avg, STDDEV(R_27) as R_27_stddev, MIN(R_27) as R_27_min, MAX(R_27) as R_27_max,
  AVG(D_108) as D_108_avg, STDDEV(D_108) as D_108_stddev, MIN(D_108) as D_108_min, MAX(D_108) as D_108_max,
  AVG(D_109) as D_109_avg, STDDEV(D_109) as D_109_stddev, MIN(D_109) as D_109_min, MAX(D_109) as D_109_max,
  AVG(D_110) as D_110_avg, STDDEV(D_110) as D_110_stddev, MIN(D_110) as D_110_min, MAX(D_110) as D_110_max,
  AVG(D_111) as D_111_avg, STDDEV(D_111) as D_111_stddev, MIN(D_111) as D_111_min, MAX(D_111) as D_111_max,
  AVG(B_39) as B_39_avg, STDDEV(B_39) as B_39_stddev, MIN(B_39) as B_39_min, MAX(B_39) as B_39_max,
  AVG(D_112) as D_112_avg, STDDEV(D_112) as D_112_stddev, MIN(D_112) as D_112_min, MAX(D_112) as D_112_max,
  AVG(B_40) as B_40_avg, STDDEV(B_40) as B_40_stddev, MIN(B_40) as B_40_min, MAX(B_40) as B_40_max,
  AVG(S_27) as S_27_avg, STDDEV(S_27) as S_27_stddev, MIN(S_27) as S_27_min, MAX(S_27) as S_27_max,
  AVG(D_113) as D_113_avg, STDDEV(D_113) as D_113_stddev, MIN(D_113) as D_113_min, MAX(D_113) as D_113_max,
  AVG(D_115) as D_115_avg, STDDEV(D_115) as D_115_stddev, MIN(D_115) as D_115_min, MAX(D_115) as D_115_max,
  AVG(D_118) as D_118_avg, STDDEV(D_118) as D_118_stddev, MIN(D_118) as D_118_min, MAX(D_118) as D_118_max,
  AVG(D_119) as D_119_avg, STDDEV(D_119) as D_119_stddev, MIN(D_119) as D_119_min, MAX(D_119) as D_119_max,
  AVG(D_121) as D_121_avg, STDDEV(D_121) as D_121_stddev, MIN(D_121) as D_121_min, MAX(D_121) as D_121_max,
  AVG(D_122) as D_122_avg, STDDEV(D_122) as D_122_stddev, MIN(D_122) as D_122_min, MAX(D_122) as D_122_max,
  AVG(D_123) as D_123_avg, STDDEV(D_123) as D_123_stddev, MIN(D_123) as D_123_min, MAX(D_123) as D_123_max,
  AVG(D_124) as D_124_avg, STDDEV(D_124) as D_124_stddev, MIN(D_124) as D_124_min, MAX(D_124) as D_124_max,
  AVG(D_125) as D_125_avg, STDDEV(D_125) as D_125_stddev, MIN(D_125) as D_125_min, MAX(D_125) as D_125_max,
  AVG(D_127) as D_127_avg, STDDEV(D_127) as D_127_stddev, MIN(D_127) as D_127_min, MAX(D_127) as D_127_max,
  AVG(D_128) as D_128_avg, STDDEV(D_128) as D_128_stddev, MIN(D_128) as D_128_min, MAX(D_128) as D_128_max,
  AVG(D_129) as D_129_avg, STDDEV(D_129) as D_129_stddev, MIN(D_129) as D_129_min, MAX(D_129) as D_129_max,
  AVG(B_41) as B_41_avg, STDDEV(B_41) as B_41_stddev, MIN(B_41) as B_41_min, MAX(B_41) as B_41_max,
  AVG(B_42) as B_42_avg, STDDEV(B_42) as B_42_stddev, MIN(B_42) as B_42_min, MAX(B_42) as B_42_max,
  AVG(D_130) as D_130_avg, STDDEV(D_130) as D_130_stddev, MIN(D_130) as D_130_min, MAX(D_130) as D_130_max,
  AVG(D_131) as D_131_avg, STDDEV(D_131) as D_131_stddev, MIN(D_131) as D_131_min, MAX(D_131) as D_131_max,
  AVG(D_132) as D_132_avg, STDDEV(D_132) as D_132_stddev, MIN(D_132) as D_132_min, MAX(D_132) as D_132_max,
  AVG(D_133) as D_133_avg, STDDEV(D_133) as D_133_stddev, MIN(D_133) as D_133_min, MAX(D_133) as D_133_max,
  AVG(R_28) as R_28_avg, STDDEV(R_28) as R_28_stddev, MIN(R_28) as R_28_min, MAX(R_28) as R_28_max,
  AVG(D_134) as D_134_avg, STDDEV(D_134) as D_134_stddev, MIN(D_134) as D_134_min, MAX(D_134) as D_134_max,
  AVG(D_135) as D_135_avg, STDDEV(D_135) as D_135_stddev, MIN(D_135) as D_135_min, MAX(D_135) as D_135_max,
  AVG(D_136) as D_136_avg, STDDEV(D_136) as D_136_stddev, MIN(D_136) as D_136_min, MAX(D_136) as D_136_max,
  AVG(D_137) as D_137_avg, STDDEV(D_137) as D_137_stddev, MIN(D_137) as D_137_min, MAX(D_137) as D_137_max,
  AVG(D_138) as D_138_avg, STDDEV(D_138) as D_138_stddev, MIN(D_138) as D_138_min, MAX(D_138) as D_138_max,
  AVG(D_139) as D_139_avg, STDDEV(D_139) as D_139_stddev, MIN(D_139) as D_139_min, MAX(D_139) as D_139_max,
  AVG(D_140) as D_140_avg, STDDEV(D_140) as D_140_stddev, MIN(D_140) as D_140_min, MAX(D_140) as D_140_max,
  AVG(D_141) as D_141_avg, STDDEV(D_141) as D_141_stddev, MIN(D_141) as D_141_min, MAX(D_141) as D_141_max,
  AVG(D_142) as D_142_avg, STDDEV(D_142) as D_142_stddev, MIN(D_142) as D_142_min, MAX(D_142) as D_142_max,
  AVG(D_143) as D_143_avg, STDDEV(D_143) as D_143_stddev, MIN(D_143) as D_143_min, MAX(D_143) as D_143_max,
  AVG(D_144) as D_144_avg, STDDEV(D_144) as D_144_stddev, MIN(D_144) as D_144_min, MAX(D_144) as D_144_max,
  AVG(D_145) as D_145_avg, STDDEV(D_145) as D_145_stddev, MIN(D_145) as D_145_min, MAX(D_145) as D_145_max,
  from `big-query-study-338516.kaggle_amex_dataset.test_data`
  group by customer_ID
),
with_had_cat_label AS (
SELECT
  customer_ID,
  CASE when count(distinct(B_30)) > 0 THEN TRUE ELSE FALSE END as had_B_30,
  CASE WHEN count(distinct(B_38)) > 0 THEN TRUE ELSE FALSE END as had_B_38,
  CASE WHEN count(distinct(D_114)) > 0 THEN TRUE ELSE FALSE END as had_D_114,
  CASE WHEN count(distinct(D_116)) > 0 THEN TRUE ELSE FALSE END as had_D_116,
  CASE WHEN count(distinct(D_117)) > 0 THEN TRUE ELSE FALSE END as had_D_117,
  CASE WHEN count(distinct(D_120)) > 0 THEN TRUE ELSE FALSE END as had_D_120,
  CASE WHEN count(distinct(D_126)) > 0 THEN TRUE ELSE FALSE END as had_D_126,
  CASE WHEN count(distinct(D_63)) > 0 THEN TRUE ELSE FALSE END as had_D_63,
  CASE WHEN count(distinct(D_64)) > 0 THEN TRUE ELSE FALSE END as had_D_64,
  CASE WHEN count(distinct(D_66)) > 0 THEN TRUE ELSE FALSE END as had_D_66,
  CASE WHEN count(distinct(D_68)) > 0 THEN TRUE ELSE FALSE END as had_D_68,
FROM
  `big-query-study-338516.kaggle_amex_dataset.test_data`
group by customer_ID
)


select 
  num_features_agg_trends.* EXCEPT(customer_ID),
  num_agg_features_trends.* EXCEPT(customer_ID),
  num_features_agg_trends_max.* EXCEPT(customer_ID),
  with_had_cat_label.* EXCEPT(customer_ID),
  num_features_last_values.*, -- here are the targets and customer_IDs
from num_features_agg_trends
left join num_agg_features_trends
on num_features_agg_trends.customer_ID = num_agg_features_trends.customer_ID
left join num_features_last_values
on num_features_last_values.customer_ID = num_agg_features_trends.customer_ID
left join num_features_agg_trends_max
on num_features_agg_trends_max.customer_ID = num_features_last_values.customer_ID
left join with_had_cat_label
on with_had_cat_label.customer_ID = num_features_last_values.customer_ID
;